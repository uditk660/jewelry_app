<style>
/* Scoped styles for customers index */
.customer-list-page{max-width:1200px;margin:22px auto;padding:0 16px}
.customer-list-header{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px}
.customer-list-header h1{margin:0;font-size:1.35rem}
.customer-card{background:#fff;border:1px solid #eef4fb;border-radius:10px;padding:14px;box-shadow:0 6px 18px rgba(15,23,42,0.04)}
.customer-search{display:flex;gap:8px;align-items:center;margin-bottom:12px}
.customer-search input{padding:8px 12px;border-radius:8px;border:1px solid #e6edf3;min-width:320px}
.customers-table{width:100%;border-collapse:collapse}
.customers-table th{background:#fbfdff;color:var(--muted);text-align:left;padding:10px;border-bottom:1px solid #eef4fb;font-weight:600}
.customers-table td{padding:12px;border-bottom:1px solid #f3f7fb;vertical-align:top}
.muted{color:var(--muted)}
.addr{max-width:320px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.actions{width:110px;text-align:right}
@media(max-width:900px){.customer-search input{min-width:160px}.addr{max-width:180px}}
</style>

<div class="customer-list-page">
  <div class="customer-list-header">
    <div>
      <h1>Customers</h1>
      <div class="small muted">Manage customers and contact/tax information</div>
    </div>
    <div>
      <%= link_to 'New Customer', new_customer_path, class: 'btn btn-primary' %>
    </div>
  </div>

  <div class="customer-card">
    <div class="customer-search">
      <form method="get" action="">
        <input type="text" name="q" value="<%= h(params[:q]) %>" placeholder="Search by name, phone, email, aadhaar/pan or gst">
        <button class="btn" type="submit">Search</button>
      </form>
      <div style="margin-left:auto" class="muted">Showing <strong><%= @customers.size %></strong> customers</div>
    </div>

    <table class="customers-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Aadhaar / PAN</th>
          <th>GST</th>
          <th>Address</th>
          <th>Created</th>
          <th class="actions"></th>
        </tr>
      </thead>
      <tbody>
        <% @customers.each do |c| %>
          <tr>
            <td><strong><%= [c.first_name, c.last_name].reject(&:blank?).join(' ') %></strong><br><span class="muted"><%= c.email.presence || '—' %></span></td>
            <td><%= c.phone.presence || '—' %></td>
            <td><%= c.email.presence || '—' %></td>
            <td><%= c.aadhaar_or_pan.presence || '—' %></td>
            <td><%= c.gst_number.presence || '—' %></td>
            <td class="addr" title="<%= h(c.address.to_s) %>"><%= c.address.present? ? truncate(c.address, length: 80) : '—' %></td>
            <td class="small muted"><%= c.created_at ? c.created_at.strftime('%b %d, %Y') : '—' %></td>
            <td class="actions">
              <%= link_to 'View', customer_path(c), class: 'btn btn-sm' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
